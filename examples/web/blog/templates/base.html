<!DOCTYPE html>
<html data-theme="light">
<head>
  <title>{% block title %}A Bitsetter's Blog{% endblock %}</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="/public/cube.png">
  <link rel="stylesheet" href="/public/pico.min.css">
  <link rel="stylesheet" href="/public/style.css">
  <link rel="stylesheet" href="/public/prism.css" data-theme="light">
  <link rel="stylesheet" href="/public/prism-okaidia.css" data-theme="dark" disabled>
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml">

  {% block meta %}{% endblock %}

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-JZBKYG0YS0"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-JZBKYG0YS0');
  </script>
</head>
<body>

<header class="container">
  <nav>
    <ul>
      <li>
        <h1 style="margin: 0;">
          <a href="/" style="text-decoration: none; color: inherit; display: flex; align-items: center; gap: 0.75rem;">
            <img src="/public/cube.png" alt="Cube icon" style="width: 48px; height: 48px;">
            A Bitsetter's Blog
          </a>
        </h1>
      </li>
    </ul>
    <ul>
      <li>
        <button id="theme-toggle" aria-label="Toggle dark mode">
          <span id="theme-icon">üåô</span>
        </button>
      </li>
    </ul>
  </nav>
  <p>I would love to change the world, but they won't give me the source code</p>

  {% set has_visible_pages = false %}
  {% if pages %}
    {% for page in pages %}
      {% if page.sort_order != 0 %}
        {% set_global has_visible_pages = true %}
      {% endif %}
    {% endfor %}
  {% endif %}

  {% if has_visible_pages %}
  <nav style="margin-top: 1rem;">
    <ul style="list-style: none; padding: 0; display: flex; gap: 0; flex-wrap: wrap; align-items: center;">
      <li><a href="/">Blog</a></li>
      {% for page in pages %}
        {% if page.sort_order != 0 %}
        <li style="margin: 0 0.75rem; color: var(--pico-muted-color);">|</li>
        <li><a href="/page/{{ page.slug }}">{{ page.title }}</a></li>
        {% endif %}
      {% endfor %}
    </ul>
  </nav>
  {% endif %}
</header>

<main class="container">
  {% block content %}{% endblock %}
</main>

<footer class="container">
  <small>
    <strong><a href="https://quest.bitsetters.com/" target="_blank" rel="noopener">Powered by Quest</a></strong><br>
    Copyright 2025 Steven Osborn, All Rights Reserved
  </small>
</footer>

<script>
  // Theme switcher
  const html = document.documentElement;
  const themeToggle = document.getElementById('theme-toggle');
  const themeIcon = document.getElementById('theme-icon');

  // Check for saved theme preference or default to light mode
  const savedTheme = localStorage.getItem('theme') || 'light';
  html.setAttribute('data-theme', savedTheme);
  themeIcon.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

  // Switch Prism theme based on saved preference
  const lightTheme = document.querySelector('link[href="/public/prism.css"]');
  const darkTheme = document.querySelector('link[href="/public/prism-okaidia.css"]');
  if (savedTheme === 'dark') {
    lightTheme.disabled = true;
    darkTheme.disabled = false;
  }

  // Toggle theme
  themeToggle.addEventListener('click', () => {
    const currentTheme = html.getAttribute('data-theme');
    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

    html.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    themeIcon.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

    // Switch Prism theme
    if (newTheme === 'dark') {
      lightTheme.disabled = true;
      darkTheme.disabled = false;
    } else {
      lightTheme.disabled = false;
      darkTheme.disabled = true;
    }

    // Force Prism to re-highlight all code blocks
    if (window.Prism) {
      Prism.highlightAll();
    }
  });
</script>

<script defer src="/public/prism.js"></script>
<script defer src="/public/prism-quest.js"></script>

</body>
</html>
